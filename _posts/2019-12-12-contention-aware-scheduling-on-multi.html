---
layout: post
title: Contention-Aware Scheduling on Multi-core Systems
date: '2019-12-12T09:29:00.001-08:00'
author: Karl Taht
tags:
- performance counters
- resource allocation
- scheduling
- resource-aware scheduling
- resource management
modified_time: '2019-12-12T09:29:29.876-08:00'
blogger_id: tag:blogger.com,1999:blog-2670908301789336410.post-6907122911679154536
blogger_orig_url: https://researchdoneright.blogspot.com/2019/12/contention-aware-scheduling-on-multi.html
---

Authors: Sergey Blagodurov, Sergey Zhuravlev, Alexandra Fedorova<br />Venue:&nbsp; &nbsp; ACM Transactions on Computer Systems 2010<br /><br />In format, this is not a traditional paper and reads more like a master's thesis. The work argues that to perform contention-aware scheduling, there must exist a classification scheme and scheduling policy. The first section of the paper dives into classification schemes. Classification in this context measures a workload's sensitivity (how much an application suffers when it receives less cache) and intensity (how much an application will harm others by utilizing the cache). The authors develop a new "Pain" scheme which characterizes both of these metrics and is able to predict contention utilizing stack distance profiles and hardware counters (LLC_LINES_IN). While the work develops procedures specifically focuses on characterizing the interactions in the LLC, the work then provides results demonstrating that LLC contention is only a small factor. Interconnect and memory controller contention often far more of an overhead than LLC itself, according to this work.<br /><br />The scheduling policy used is referred to as <i>Distributed Intensity </i>(DI)<b>&nbsp;</b>which employs&nbsp;<i>Centralized Sort</i>, which sorts applications via their miss rate. DI is a recursive, hierarchical algorithm which greedily spreads work across different scheduling domains. The scheduling hierarchy is arranged in similar fashion to CFS, which uses Core, Pairs of Cores, and then NUMA-domains. However, unlike CFS, the scheduling all happens globally, meaning that each assignment traverses the entire hierarchy, instead of allowing the individual hierarchies to perform scheduling within their domain. This is likely an implementation/explanation simplification--there's no algorithmic reason this could not be done and maintain the same policy. The authors utilize two versions -- one which measures characterizes applications offline, and another which performs characterizations online. The online characterization is overall marginally worse than the offline, a positive result. The end result of the algorithm is evenly spreading high-miss rate workloads around the system, which results in an overall performance improvement of ~2% for workloads tested (Spec2006 mixes). The authors also show DI can be adapted to target lower energy as well.<br /><br />Interesting Notes:<br /><br /><ul><li>Despite an earlier section proving that the newly proposed "Pain" metric outperforms using miss rates, the authors offer that obtaining stack distance profiles (SDP) is not desirable. This seems intuitively, until it is pointed out that RapidMRC provides a methodology to obtain SDPs online using performance counters.&nbsp;</li><li>Pre-emption is used only in the DIO (DI-online) scenario at 1B cycle intervals (~2Hz).</li><li>Non-LLC contention is very relevant, but hardly used in the algorithm. Clearly more opportunity exists, especially if we consider other resources like I-cache thrashing, memory bandwidth, and by extension, memory latency.</li><li>Assumes # threads &lt; # cores</li><li>No notion of fairness</li></ul><br /><br />